<head>
  <meta charset="utf-8">
  <title>Hyper-V安装并使用eNSP</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/clean.js"></script>
<meta name="generator" content="Hexo 7.3.0"></head>

<header class="topbar">
  <!--div class="logo"><a href="/">風によって舞いお落ちる的blog</a></div-->
  <div class="logo"><a target="_blank" rel="noopener" href="https://github.com/kazeniyottemaiootiru">風によって舞いお落ちる的blog</a></div>
  <nav>
    
      <a href="/">Home</a>
    
      <a href="/categories">Categories</a>
    
      <a href="/tags">Tags</a>
    
      <a href="/about">About</a>
    
  </nav>
</header>


<main class="post-page">
  <div class="mask"></div>
  <div class="post-layout">
    <div class="post-container">
      <h1>Hyper-V安装并使用eNSP</h1>
      <p class="post-meta">2025-09-07</p>
      <div class="post-content">
        <blockquote>
<p>需要注意Hyper-V是只在Windows 10及以后的Windows的专业版及更高级别的Windows上有这个功能，<strong>家庭&#x2F;家庭单语言版没有这个功能</strong>，所以看本教程之前请先确认您当前使用的Windows的版本，并确认是否开启了CPU的虚拟化。</p>
</blockquote>
<h2 id="1-确认CPU虚拟化是否开启"><a href="#1-确认CPU虚拟化是否开启" class="headerlink" title="1. 确认CPU虚拟化是否开启"></a>1. 确认CPU虚拟化是否开启</h2><p>在鼠标右键单击任务栏选择<code>任务管理器</code>或者<code>Crtl + Shift + Esc</code>打开任务管理器，选择性能选项卡下的CPU，然后查看虚拟化是否为已启用，如果不是请搜索对应主板和CPU启用虚拟化的方法，通常需要在主板的BIOS中设置，设备需要重启，所以建议使用非启用Hyper-V设备搜索教程，在此本教程不提供启用CPU虚拟化的教程。</p>
<h2 id="2-启用Hyper-V"><a href="#2-启用Hyper-V" class="headerlink" title="2. 启用Hyper-V"></a>2. 启用Hyper-V</h2><p>在Windows任务栏搜索框输入<code>control pannal</code>打开控制面板，将查看方式改为类别，点击程序，在程序和功能下面点击<code>启用或关闭Windows功能</code>，在弹出的窗口中将Hyper-V勾选上，然后等待并重启设备即可。重启后点击<code>开始-&gt;全部-&gt;Windows工具</code>或者在搜索框中输入Hyper-V进行搜索，确认是否启用成功，如下图所示有着<code>Hyper-V快速创建</code>和<code>Hyper-V管理器</code>。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/windows_kit.png" alt="Windows 工具截图" title="Windows 工具截图"></p>
<h2 id="3-下载Windows安装镜像"><a href="#3-下载Windows安装镜像" class="headerlink" title="3. 下载Windows安装镜像"></a>3. 下载Windows安装镜像</h2><h3 id="官方下载"><a href="#官方下载" class="headerlink" title="官方下载"></a>官方下载</h3><p>在微软官网的下载中心选择Windows 10或者<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/software-download/windows10">点击此处</a>，见到下面的网页。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/microsoft_download.png" alt="Microsoft下载" title="Microsoft下载"><br>选择<code>创建 Windows 10 安装媒体</code>下的<code>立即下载</code>，下载获得一个<code>MediaCreationTool_22H2.exe</code>的程序，打开该程序会出现如下窗口，如果没有并弹出许可下载有问题，请检查设备网络状态。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/win10_official_download.png" alt="win10 官方下载" title="win10 官方安装程序"><br>接受完许可条款软件会询问想要执行的操作选择<code>为另一台电脑创建安装介质（U盘、DVD或ISO文件）</code>，然后根据需求选择安装的系统的语言，版本保持默认不要修改为Windows 10 家庭单语言版，家庭单语言版会有一定的功能缺失，体系结构不要改为32位，32位的系统会导致一些应用无法使用，所以尽量保持64位即可。<br>接下来就选择ISO文件并选择镜像下载的路径即可。</p>
<h3 id="第三方下载"><a href="#第三方下载" class="headerlink" title="第三方下载"></a>第三方下载</h3><p>在这里推荐到<a target="_blank" rel="noopener" href="https://next.itellyou.cn/Original">NEXT, ITELLYOU</a>下载，网站界面如下。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/NEXT,%20ITELLYOU.png" alt="NEXT, ITELLYOU界面" title="NEXT, ITELLYOU界面"><br>然后选择Windows 10中的22H2的<code>Windows 10 (consumer editions), version 22H2 (updated Aug 2025) (x64) - DVD (Chinese-Simplified)</code>下载，复制自己的下载器支持的下载连接，这个资源站支持ED2K和BT下载，这里不过多介绍。</p>
<h2 id="4-在Hyper-V中创建虚拟机"><a href="#4-在Hyper-V中创建虚拟机" class="headerlink" title="4. 在Hyper-V中创建虚拟机"></a>4. 在Hyper-V中创建虚拟机</h2><p>首先打开<code>Hyper-V管理器</code>可以看到如下界面，由于我已经安装了一个win10的虚拟机所以虚拟机中有条目。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/hyper-v_info.png" alt="Hpyer-V info" title="Hyper-V管理器的界面"><br>点击右侧的<code>新建-&gt;虚拟机</code>创建虚拟机，虽然右侧有<code>快速创建...</code>，但不方便后续的虚拟机的参数的调整。<br>在<code>指定名称和位置</code>部分名称尽量设为自己易记的英文字符（<strong>不要带空格</strong>），方便后面的部分使用，设置路径前先把<code>将虚拟机存储在其它位置</code>的复选框勾上，路径尽量设为除C盘外的路径。由于eNSP对电脑的性能有一定的要求，<strong>建议内存部分分配8GB（8192MB）</strong>。<br><code>配置网络</code>中的连接选择<code>Default Switch</code>，否则虚拟机中没有因特网。Windows 10最低配置要求硬盘空间要不少于20GB，所以虚拟磁盘大小设为不少于20GB，<strong>推荐设为60GB</strong>，方便后续软件安装。<br>在安装选项中选择<code>从可启动的CD/DVD-ROM安装操作系统</code>，然后选择<code>映像文件</code>，将下载的Windows安装镜像路径填入输入框中。完成后会虚拟机处出现新创建的虚拟机，就如上面的图片所示。</p>
<h2 id="5-安装Windows"><a href="#5-安装Windows" class="headerlink" title="5. 安装Windows"></a>5. 安装Windows</h2><p>双击或者选中这个虚拟机点击<code>连接...</code>打开新窗口，点击窗口中的启动按钮，并按键盘上的任意键，如果出现IPv4等字样点击<code>操作(A)</code>中的<code>Ctrl + Alt + Delete(C)</code>或按下快捷键<code>Ctrl + Alt + End</code>后按下键盘上的任意键进入系统安装的流程。<br>引导进入后选择现在安装，我没有安装密钥，选择安装的版本（个人推荐安装专业版），自定义，现在安装等待即可，中途会重启几次这是正常现象。<br>接着进入OOBE界面，具体流程可以参考视频。<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1UtbxeDELK/">参考视频链接</a></p>
<h2 id="6-启用Hyper-V的嵌套虚拟化（重要）"><a href="#6-启用Hyper-V的嵌套虚拟化（重要）" class="headerlink" title="6. 启用Hyper-V的嵌套虚拟化（重要）"></a>6. 启用Hyper-V的嵌套虚拟化（重要）</h2><blockquote>
<p>由于Hyper-V默认关闭嵌套虚拟化，会导致在仿真时<strong>导致虚拟机彻底卡死</strong>，所以这步十分重要。</p>
</blockquote>
<p>在创建好虚拟机后在物理机以管理员权限运行powershell，如果忘记虚拟机的名字，可以在powershell中执行下面的命令并查看虚拟机的状态。</p>
<pre><code class="language-powershell">Get-VM
</code></pre>
<p>powershell将会输出如下的内容。<br><img src="/images/Hyper-V%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8eNSP/powershell_output.png" alt="powershell output" title="powershell 输出"></p>
<p>请确保State下要启用虚拟化的虚拟机处于关闭状态（off），然后在powershell中输入下面的指令，其中<strong>把指令中的<code>&lt;VMName&gt;</code>替换为虚拟机的名字</strong>。更高级的操作可以参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows-server/virtualization/hyper-v/enable-nested-virtualization">微软官方文档</a>。</p>
<pre><code class="language-powershell">Set-VMProcessor -VMName &lt;VMName&gt; -ExposeVirtualizationExtensions $true
</code></pre>
<p>在执行完操作后，再次启动虚拟机进行后续操作。<br>如果要终止嵌套虚拟化将末尾的<code>$true</code>换位<code>$false</code>即可。</p>
<h2 id="7-安装eNSP"><a href="#7-安装eNSP" class="headerlink" title="7. 安装eNSP"></a>7. 安装eNSP</h2><p>网上有许多教程，仅提供安装顺序。<br>下面这些软件可以乱序安装，VirtualBox选择5.5版本左右，不要太新否则不支持。</p>
<blockquote>
<p>WinPcap<br>VirtualBox<br>Wireshark</p>
</blockquote>
<p>eNSP最后安装，接着测试是否可以使用，我自己测试时可以正常运行。</p>

      </div>
    </div>

    <!-- 目录 -->
    <aside class="post-toc">
      <div class="toc-header">
        <span>目录</span>
        <button class="toc-collapse">
          <img src="/images/access/collapse.png" alt="collapse" class="collapse-icon">
        </button>
      </div>
      <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%A1%AE%E8%AE%A4CPU%E8%99%9A%E6%8B%9F%E5%8C%96%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF"><span class="toc-text">1. 确认CPU虚拟化是否开启</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%90%AF%E7%94%A8Hyper-V"><span class="toc-text">2. 启用Hyper-V</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%B8%8B%E8%BD%BDWindows%E5%AE%89%E8%A3%85%E9%95%9C%E5%83%8F"><span class="toc-text">3. 下载Windows安装镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%B8%8B%E8%BD%BD"><span class="toc-text">官方下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%8B%E8%BD%BD"><span class="toc-text">第三方下载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%9C%A8Hyper-V%E4%B8%AD%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-text">4. 在Hyper-V中创建虚拟机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%AE%89%E8%A3%85Windows"><span class="toc-text">5. 安装Windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%90%AF%E7%94%A8Hyper-V%E7%9A%84%E5%B5%8C%E5%A5%97%E8%99%9A%E6%8B%9F%E5%8C%96%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89"><span class="toc-text">6. 启用Hyper-V的嵌套虚拟化（重要）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%AE%89%E8%A3%85eNSP"><span class="toc-text">7. 安装eNSP</span></a></li></ol>
      </div>
    </aside>
  </div>
</main>

<footer>
  <p>© 2025 風によって舞いお落ちる的blog. All rights reserved.</p>
</footer>


<!-- Prism 样式 -->
<link rel="stylesheet" href="/css/prism-tomorrow.min.css">
<link rel="stylesheet" href="/css/prism-line-numbers.min.css">
<link rel="stylesheet" href="/css/code.css">
<link rel="stylesheet" href="/css/prism.css">

<!-- Prism 高亮 -->
<script src="/js/prism.min.js"></script>
<script src="/js/prism-line-numbers.min.js"></script>

<!-- TOC 折叠 JS -->
<script src="/js/toc.js"></script>

<!-- 代码复制 JS -->
<script src="/js/code.js"></script>
<script src="/js/prism.js"></script>